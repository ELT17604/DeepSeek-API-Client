# DeepSeek API 客户端 GUI 说明书

## 1. 程序简介

本程序是一个基于图形用户界面（GUI）的DeepSeek API客户端。它允许用户通过输入API密钥，选择DeepSeek提供的语言模型，并与之进行交互式聊天。程序支持API密钥的本地加密存储、查询账户余额、Markdown格式渲染聊天内容以及实时状态监控等功能，旨在提供一个便捷的DeepSeek API使用体验。

## 2. 界面按钮作用

*   **API密钥区域**:
    *   `API密钥输入框`: 用于输入您的DeepSeek API Key。
    *   `初始化`/`修改`按钮:
        *   **初始化**: 验证API Key，成功后初始化客户端并尝试加载模型列表。按钮变为“修改”。
        *   **修改**: 允许重新输入和初始化新的API Key。
*   **模型选择区域**:
    *   `模型下拉框`: 显示从API获取的可选模型列表，供用户选择。
    *   `刷新模型`按钮: 手动重新从服务器获取最新的可用模型列表。
*   **控制按钮区域**:
    *   `查询余额`按钮: 查询当前API Key关联账户的余额信息。
    *   `开始聊天`按钮: 当API Key初始化成功并选择模型后，点击此按钮以启用聊天输入功能。
    *   `清空输出`按钮: 清除聊天输出区域的所有内容。
    *   `Markdown: 开/关`按钮: 切换聊天内容是否以Markdown格式进行渲染。
    *   `状态监控`/`隐藏状态`按钮: 打开或关闭一个独立的窗口，实时显示客户端、网络、模型、HTTP及聊天状态。
*   **用户输入区**:
    *   `您: (输入框)`: 在此区域输入您想发送给模型的聊天内容。支持回车发送，Ctrl+Enter换行。
*   **输入控制按钮**:
    *   `发送`按钮: 将输入框中的内容发送给模型。
    *   `停止`按钮: 如果模型正在流式输出回复，点击此按钮可以中断输出。
    *   `新会话`按钮: 清空当前的聊天记录，开始一个全新的对话。
    *   `结束聊天`按钮: 结束当前聊天会话，并禁用输入框。
*   **字体大小调节区域** (界面底部):
    *   `－`按钮: 减小输出区域的字体大小。
    *   `字体大小输入框`: 可以直接输入数字来设定输出区域的字体大小。
    *   `＋`按钮: 增大输出区域的字体大小。
*   **API Key 管理区域** (界面底部):
    *   `清除API密钥`按钮: 删除本地保存的（加密的）API Key文件。

## 3. 如何进行一次聊天

1.  **启动程序**。
2.  在顶部的“API密钥”输入框中**输入您的DeepSeek API Key**。
3.  点击右侧的“**初始化**”按钮。
    *   如果API Key有效，客户端将初始化，按钮变为“修改”，并会自动尝试加载可用模型。
    *   如果初始化失败，请检查API Key或网络，并留意可能的错误提示。
4.  从“模型”下拉框中**选择一个您想使用的模型**。如果列表为空或想更新，可点击“刷新模型”按钮。
5.  点击“**开始聊天**”按钮。下方的用户输入框将变为可用状态。
6.  在“您:”旁边的文本框中**输入您想说的内容**。
7.  点击“**发送**”按钮，或直接按键盘上的**回车(Enter)**键。
8.  模型的回复将显示在中间的输出区域。
9.  您可以继续输入内容进行多轮对话。
10. 若想开始一个全新的对话，点击“**新会话**”。
11. 若想结束当前聊天，点击“**结束聊天**”。

## 4. 附录

### 附录1：指示灯颜色说明

程序界面和状态监控窗口包含多种指示灯，它们的颜色含义如下：

*   **主界面指示灯** (位于“状态监控”按钮左侧):
    *   **右侧指示灯 (聊天状态)**:
        *   🔴 `红色`: 聊天未就绪或已结束。
        *   🟡 `黄色`: 正在聊天中或模型正在流式输出回复。
        *   🟢 `绿色`: 聊天已就绪，可以输入并发送消息。
    *   **左侧指示灯 (综合状态)**:
        *   🟢 `绿色`: 客户端、网络、模型选择、HTTP连接均正常。
        *   🟡 `黄色`: 部分功能存在警告，例如网络延迟较高，或模型未选择但其他正常。
        *   🔴 `红色`: 存在关键问题，如客户端未初始化、网络断开、HTTP请求错误等。

*   **状态监控窗口指示灯**:
    *   **客户端**:
        *   🔴 `红色`: 无API密钥 / 初始化失败。
        *   🟡 `黄色`: API密钥已输入但未初始化 / 正在初始化中。
        *   🟢 `绿色`: 客户端已成功初始化。
    *   **网络**:
        *   🔴 `红色`: 网络连接超时 / 已断开。
        *   🟡 `黄色`: 网络连接正常，但延迟较高。
        *   🟢 `绿色`: 网络连接良好，延迟较低。
        *   ⚫ `灰色`: 正在检查网络状态。
    *   **模型**:
        *   🔴 `红色`: 模型服务不可用 / 获取模型列表失败 / 未选择模型。
        *   🟡 `黄色`: 有可用模型但当前未选择。
        *   🟢 `绿色`: 已成功选择模型 (并显示模型名称)。
    *   **HTTP**:
        *   🔴 `红色`: HTTP请求发生客户端错误 (如 401认证失败, 403禁止访问, 404未找到, 429请求频繁) 或网络层错误。
        *   🟡 `黄色`: HTTP请求发生服务器端错误 (如 500, 502, 503) 或其他非严重错误。
        *   🟢 `绿色`: HTTP请求成功 (如 200 OK)。
    *   **聊天**:
        *   🔴 `红色`: 聊天未就绪。
        *   🟡 `黄色`: 正在聊天中 / 模型正在流式输出回复。
        *   🟢 `绿色`: 聊天已就绪，可以开始对话。

### 附录2：可能遇到的各种问题及解决方案

1.  **问题：程序启动时提示 "cryptography库未安装..."**
    *   **原因**：您的Python环境中缺少`cryptography`库，该库用于API密钥的本地加密存储。
    *   **解决方案**：打开命令行终端 (cmd或PowerShell)，输入 `pip install cryptography` 并回车安装。程序在缺少此库时仍可运行，但API密钥将不会被加密保存在本地。

2.  **问题：点击“初始化”后，提示API密钥无效或认证失败 (如HTTP 401错误)。**
    *   **原因**：
        *   输入的API Key不正确。
        *   API Key已过期或被禁用。
        *   账户余额不足或存在其他账户问题。
    *   **解决方案**：
        *   仔细检查并重新输入API Key。
        *   登录DeepSeek官方网站检查您的API Key状态和账户信息。
        *   查看弹出的HTTP错误对话框以获取更详细的错误信息。

3.  **问题：模型列表为空，或“刷新模型”失败。**
    *   **原因**：
        *   网络连接问题，无法访问DeepSeek API。
        *   API Key可能没有权限获取模型列表。
        *   DeepSeek服务器临时性问题。
    *   **解决方案**：
        *   检查您的网络连接（可查看状态监控窗口的网络指示灯）。
        *   确认API Key的权限。
        *   稍后再试。
        *   查看弹出的HTTP错误对话框。

4.  **问题：发送消息后长时间无响应或报错 (如超时、HTTP 5xx错误)。**
    *   **原因**：
        *   网络不稳定或中断。
        *   DeepSeek模型服务暂时不可用或负载过高。
        *   请求内容可能过大或触发了某些限制。
        *   API Key的调用频率达到上限 (HTTP 429错误)。
    *   **解决方案**：
        *   检查网络连接。
        *   尝试更换其他模型。
        *   稍等片刻再试。
        *   点击“查询余额”检查账户是否因欠费等原因受限。
        *   如果频繁出现429错误，请降低请求频率。
        *   查看弹出的HTTP错误对话框或输出区域的错误提示。

5.  **问题：输出区域文本显示不全或格式混乱。**
    *   **原因**：
        *   Markdown渲染可能对特定复杂内容处理不完美。
        *   字体或界面元素大小设置不当。
    *   **解决方案**：
        *   尝试点击“Markdown: 开/关”按钮切换到纯文本模式查看。
        *   使用界面底部的字体大小调节功能调整字体。

6.  **问题：点击“清除API密钥”后，下次启动仍自动填入密钥。**
    *   **原因**：清除操作可能因文件权限等问题失败。
    *   **解决方案**：手动删除API密钥文件。该文件位于用户主目录下的 `.DS_API_CLI` 文件夹中，文件名为 `API_KEY` (例如 `C:\Users\YourUserName\.DS_API_CLI\API_KEY`)。

7.  **问题：状态监控窗口不显示或位置不佳。**
    *   **原因**：窗口被其他程序遮挡或程序未能正确获取主窗口位置。
    *   **解决方案**：尝试先关闭状态监控窗口（点击“隐藏状态”），然后再次点击“状态监控”按钮重新打开。



```python
# Copyright (c) 2025 1f84@ELT Group
# Email: elt17604@outlook.com
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License version 3 as published by
# the Free Software Foundation.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program. If not, see <https://www.gnu.org/licenses/>.
#
# Additional Terms:
# This software may not be used for commercial purposes.
# Any redistribution of this software must retain this notice.

```